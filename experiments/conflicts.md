
# Correcting annotations for the misclssified proteins
* the dataset by Edgar 2018 (Peerj paper) is small, we can not get larger cluster to propose annotations
 
## Conflicts analysis between annotations in the sequences and clusters at nr95

### Examples

* convert Boa output to one line for each sequence

```
input:
count[101M][101M][9755] = 1
count[101M][1MTJ][9755] = 1
count[101M][1MTK][9755] = 1
count[101M][1MYM][9755] = 1

output:
101M:101M,9755=1;1MTJ,9755=1;1MTK,9755=1;1MYM,9755=1
```

* Sequence 1C08 belongs to cluster ``` 1C08:55275953```

```
1C08:10090=2;83333=4;9031=22;9103=1
1CSG:32630=1;9606=14

```

* Sequence: Cluster

```
1CSG:27522393

```

* Cluster:

```
55275953:10090=1;83333=4;8839=6;9031=22;9103=1

27522393:10116=1;10245=3;111789=1;1151248=1;1446742=1;1446743=2;1701613=3;1958742=1;32630=5;562=61;563944=1;573235=1;622=1;754093=1;77133=5;83334=1;869678=1;9597=1;9598=2;9601=2;9606=33


```


## Analysis

* location: ```/pylon5/mc5fr5p/hbagheri/00_rawData/verification_NR```
* files that contain sequences; clusters, and the dictionary of seq:cluster
  - 95-part-r-00000seq_cluster
  - part-r-00000_converted
  - part-r-00000_converted_1col_sorted_filtered_cut1

* Code and prameters to run conflicts

```
 /Users/hbagheri/Downloads/95-part-r-00000seq_cluster /Users/hbagheri/Downloads/mis-ann/clstrCount2019V3/part-r-00000_converted /Users/hbagheri/Downloads/mis-ann/seqCount2019V2/part-r-00000_converted_1col_sorted_filtered_cut1

```



### Details of conflicts in sequence and cluster annotations
##### Sequence   `1FE1` that belongs to a cluster ID  `82`
* Top three taxonomic assignment within a cluster and their frequencies: `[('9606', 86), ('9913', 65), ('9823', 56)]`
* confidence score: `86/(86+65+56) = 0.41`

##### Sequence `AAB18559` belongs to the cluster ID `18982245`
* Top three taxonomic assignment within a cluster and their frequencies:  `[('562', 3269), ('624', 55), ('623', 20)]`
* confidence score: `3269/(3269+55+20) = 0.97`
* cluster `18982245` all info:
```text
18982245:1001988=1;1001989=1;1001991=1;1005442=1;1005462=1;1005463=1;1005464=1;1005550=1;1005562=1;1005564=1;
1005565=1;1005567=1;1010817=1;1038927=2;1040638=1;1042803=1;1048254=3;1048256=1;1048265=1;1048266=1;1048334=1;
1050617=1;1055533=1;1055534=1;1055540=1;1055541=1;1055542=1;1055543=1;1055545=1;1068614=1;1068615=1;1068616=1;
1068617=1;1068618=1;1068619=1;1068620=1;1068621=1;1069495=1;1072459=1;1086030=1;1089445=1;1090926=1;1090927=1;
1090928=1;1090929=1;1090930=1;1097579=1;1105330=1;1110693=1;1115511=1;1115997=1;1115998=1;1115999=1;1116000=1;
1116001=1;1116002=1;1116003=1;1116004=1;1116005=1;1116006=1;1116007=1;1116008=1;1116009=1;1116010=1;1116011=1;
1116012=1;1116013=1;1116014=1;1116015=1;1116016=1;1116017=1;1116018=1;1116019=1;1116020=1;1116021=1;1116022=1;
1116023=1;1116024=1;1116025=1;1116026=1;1116027=1;1116028=1;1116029=1;1116030=1;1116031=1;1116032=1;1116033=1;
1116034=1;1116035=1;1116036=1;1116037=1;1116038=1;1116040=1;1116041=1;1116042=1;1116043=1;1116044=1;1116046=1;
1116047=1;1116048=1;1116049=1;1116050=1;1116051=1;1116052=1;1116053=1;1116054=1;1116055=1;1116056=1;1116057=1;
1116058=1;1116059=1;1116060=1;1116061=1;1116062=1;1116063=1;1116064=1;1116065=1;1116066=1;1116067=1;1116068=1;
1116069=1;1116070=1;1116071=1;1116072=1;1116073=1;1116074=1;1116075=1;1116076=1;1116077=1;1116078=1;1116079=1;
1116080=1;1116081=1;1116082=1;1116083=1;1116084=1;1116085=1;1116086=1;1116087=1;1116088=1;1116089=1;1116090=1;
1116091=1;1116092=1;1116093=1;1116094=1;1116095=1;1116096=1;1116097=1;1116098=1;1116099=1;1116100=1;1116101=1;
1116102=1;1116103=1;1116104=1;1116105=1;1116106=1;1116107=1;1116108=1;1116109=1;1116110=1;1116111=1;1116112=1;
1116113=1;1116115=1;1116116=1;1116117=1;1116118=1;1116119=1;1116120=1;1116122=1;1116123=1;1116124=1;1116126=1;
1116127=1;1116128=1;1116130=1;1116131=1;1116132=1;1116133=1;1116134=1;1116135=1;1116137=1;1116139=1;1116140=1;
1116141=1;1116142=1;1116143=1;1116144=1;1116145=1;1116146=1;1116147=1;1116148=1;1116149=1;1116150=1;1116151=1;
1116152=1;1116153=1;1116154=1;1116155=1;1116156=1;1116157=1;1116158=1;1116159=1;1116160=1;1116161=1;1116162=1;
1116163=1;1116164=1;1116165=1;1116166=1;1116167=1;1116168=1;1116169=1;1116170=1;1116171=1;1116172=1;1116173=1;
1116174=1;1116175=1;1116176=1;1116177=1;1116178=1;1116179=1;1116180=1;1116181=1;1116182=1;1116183=1;1116184=1;
1116185=1;1116186=1;1116187=1;1116188=1;1116189=1;1116190=1;1116191=1;1116192=1;1116193=1;1116194=1;1116471=1;
1117111=1;1125635=1;1125636=1;1125637=1;1125638=1;1125639=1;1125640=1;1125641=1;1125642=1;1125643=1;1125644=1;
1125645=1;1125646=1;1125647=1;1125648=1;1125649=1;1125650=1;1125651=1;1125652=1;1127356=1;1133852=2;1133853=1;
1134782=1;1137135=1;1144302=1;1144303=1;1163738=1;1165939=1;1165940=1;1165941=1;1165942=1;1165943=1;1165944=1;
1165945=1;1165946=1;1165947=1;1165949=1;1165950=1;1165951=1;1165952=1;1165953=1;1167694=1;1169315=1;1169318=1;
1169320=1;1169321=1;1169323=1;1169324=1;1169329=1;1169331=1;1169332=1;1169333=1;1169343=1;1169345=1;1169348=1;
1169349=1;1169351=1;1169352=1;1169353=1;1169354=1;1169355=1;1169357=1;1169358=1;1169359=1;1169361=1;1169363=1;
1169365=1;1169367=1;1169368=1;1169369=1;1169373=1;1169379=1;1169380=1;1169382=1;1169383=1;1169388=1;1169396=1;
1169397=1;1169402=1;1169664=1;1173689=1;1173690=2;1176728=1;1181727=1;1181730=1;1181731=1;1181736=1;1181743=1;
1181744=1;1181745=1;1181746=1;1181748=1;1181749=1;1181750=1;1181754=1;1181756=1;1181758=1;1181759=1;1181767=1;
1181768=1;1181771=1;1181774=1;1181778=1;1181779=1;1181780=1;1181781=1;1182655=1;1182657=1;1182658=1;1182659=1;
1182661=1;1182668=1;1182671=1;1182673=1;1182675=1;1182676=1;1182677=1;1182678=1;1182680=1;1182681=1;1182682=1;
1182683=1;1182684=1;1182685=1;1182686=1;1182687=1;1182688=1;1182689=1;1182694=1;1182697=1;1182698=1;1182699=1;
1182700=1;1182701=1;1182702=1;1182703=1;1182704=1;1182706=1;1182707=1;1182708=1;1182710=1;1182711=1;1182714=1;
1182715=1;1182716=1;1182717=1;1182718=1;1182719=1;1182720=1;1182722=1;1182723=1;1182724=1;1182726=1;1182728=1;
1182729=1;1182730=1;1182731=1;1182732=1;1182733=1;1182737=1;1182738=1;1196033=1;1200752=1;1224=1;1227813=1;
1227814=1;1232150=1;1232151=1;1232154=1;1240758=1;1240759=1;1240760=1;1240761=1;1240762=1;1240763=1;1240764=1;
1240765=1;1240766=1;1240767=1;1240768=1;1240769=1;1240770=1;1240771=1;1240772=1;1240773=1;1240774=1;1240775=1;
1240776=1;1240777=1;1240778=1;1240779=1;1245474=1;1246623=1;1268238=1;1268977=1;1268978=1;1268979=1;1268982=1;
1268985=1;1268986=1;1268987=1;1268992=1;1268993=1;1268995=1;1268996=1;1268997=1;1268998=1;1268999=1;1269000=1;
1269003=1;1269007=1;1274814=1;1279005=1;1280937=1;1280961=1;1280964=1;1280969=1;1280973=1;1280980=1;1280984=1;
1280986=1;1280991=1;1280993=1;1280994=1;1280995=1;1281000=1;1281007=1;1281010=1;1281017=1;1281019=1;1281022=1;
1281024=1;1281025=1;1281034=1;1281042=1;1281046=1;1281049=1;1281051=1;1281052=1;1281056=1;1281058=1;1281059=1;
1281064=1;1281066=1;1281067=1;1281068=1;1281069=1;1281072=1;1281073=1;1281078=1;1281080=1;1281083=1;1281084=1;
1281088=1;1281096=1;1281097=1;1281098=1;1281103=1;1281109=1;1281110=1;1281114=1;1281115=1;1281116=1;1281122=1;
1281127=1;1281133=1;1281135=1;1281136=1;1281142=1;1281147=1;1281149=1;1281154=1;1281158=1;1281165=1;1281166=1;
1281168=1;1281169=1;1281171=1;1281172=1;1281175=1;1281179=1;1281189=1;1281191=1;1281193=1;1281201=1;1281204=1;
1281206=1;1281208=1;1281210=1;1281213=1;1281214=1;1281218=1;1281227=1;1281233=1;1281235=1;1281237=1;1281238=1;
1281239=1;1281242=1;1281243=1;1281247=1;1281253=1;1281254=1;1281261=1;1281270=1;1281273=1;1281275=1;1282=1;
1288825=1;1311757=1;1327978=1;1328436=1;1328437=1;1328438=1;1328439=1;1328440=1;1328441=1;1328442=1;1328443=1;
1328444=1;1328445=1;1328448=1;1331061=1;1331062=1;1331063=1;1331064=1;1331065=1;1333535=1;1333536=1;1333537=1;
1335303=1;1335304=1;1335916=1;1337384=1;1337385=1;1358422=1;1370107=1;1385755=1;1389419=1;1389420=1;1392850=1;
1392854=1;1392858=1;1400023=1;1400156=1;1400157=1;1403831=1;1403943=1;1404262=1;1405292=1;1405293=2;1405294=1;
1405295=1;1411645=1;1412834=1;1416670=1;1416672=1;1416675=1;1416676=1;1417796=1;1432547=1;1432548=1;1432555=2;
1433129=1;1433131=1;1435461=1;1438669=1;1438675=1;1438678=1;1438686=1;1438687=1;1438688=1;1438691=1;1438693=1;
1438694=1;1438695=1;1438696=1;1441627=1;1444036=1;1444037=1;1444038=1;1444040=1;1444041=1;1444042=1;1444043=1;
1444044=1;1444045=1;1444047=1;1444049=1;1444051=1;1444052=1;1444053=1;1444054=2;1444057=1;1444059=1;1444062=1;
1444063=1;1444064=1;1444068=1;1444069=1;1444070=1;1444071=1;1444072=1;1444074=1;1444075=1;1444077=1;1444079=1;
1444080=1;1444081=1;1444082=2;1444083=1;1444085=1;1444087=1;1444089=1;1444090=1;1444091=1;1444092=1;1444094=1;
1444095=1;1444096=1;1444097=1;1444098=1;1444099=1;1444101=1;1444102=1;
1444103=1;1444104=1;1444106=1;1444107=1;1444108=2;1444111=1;1444114=1;1444115=1;1444116=1;1444117=1;1444118=1;
1444120=1;1444121=1;1444122=1;1444123=1;1444125=1;1444126=1;1444127=1;1444128=1;1444129=1;1444130=1;1444132=1;
1444137=1;1444138=1;1444139=1;1444140=1;1444141=1;1444142=1;1444143=2;1444146=1;1444147=1;1444148=1;1444150=1;
1444152=1;1444153=1;1444154=1;1444155=1;1444156=1;1444157=1;1444160=1;1444161=1;1444165=1;1444166=1;1444167=1;
1444168=1;1444169=1;1444170=1;1444174=1;1444175=1;1444176=1;1444180=1;1444181=1;1444182=1;1444183=1;1444184=1;
1444185=1;1444187=1;1444188=1;1444190=1;1444193=1;1444194=1;1444199=1;1444200=1;1444201=1;1444204=1;1444205=1;
1444206=1;1444207=1;1444209=1;1444210=1;1444211=1;1444212=1;1444215=1;1444216=1;1444217=1;1444218=1;1444219=1;
1444222=1;1444223=1;1444224=1;1444225=1;1444230=1;1444231=1;1444232=1;1444233=1;1444234=1;1444237=1;1444238=1;
1444239=1;1444240=1;1444241=1;1444243=1;1444244=1;1444245=1;1444246=1;1444247=1;1444248=1;1444249=1;1444251=1;
1444252=1;1444254=2;1444256=1;1444259=1;1444261=1;1444262=1;1444263=1;1444264=1;1444266=1;1444267=1;1444268=1;
1444269=1;1444272=1;1444273=1;1444274=1;1444275=1;1444276=1;1444279=1;1444280=2;1444282=1;1445862=1;1446497=2;
1446498=1;1446499=1;1446500=1;1446501=1;1446502=1;1446503=1;1446504=1;1446505=1;1446506=1;1446507=1;1446508=1;
1446509=1;1446510=1;1446511=1;1446512=1;1446513=1;1446514=1;1446515=1;1446516=1;1446517=1;1446518=1;1446519=1;
1446520=1;1446521=1;1446522=1;1446523=1;1446524=1;1446525=1;1446526=1;1446527=1;1446528=1;1446529=1;1446530=1;
1446531=1;1446532=1;1446533=1;1446534=1;1446535=1;1446536=1;1446537=1;1446538=1;1446539=1;1446540=1;1446541=1;
1446542=1;1446543=1;1446545=1;1446546=1;1446547=1;1446548=1;1446549=1;1446551=1;1446552=1;1446553=1;1446554=1;
1446555=1;1446556=1;1446557=1;1446558=1;1446559=1;1446560=1;1446561=1;1446562=1;1446563=1;1446564=1;1446565=1;
1446566=1;1446567=1;1446568=1;1446569=1;1446570=1;1446571=1;1446572=1;1446573=1;1446574=1;1446575=1;1446576=1;
1446578=1;1446580=1;1446583=1;1446584=1;1446599=1;1446601=1;1446603=1;1446605=1;1446608=1;1446703=1;1446704=1;
1446706=1;1446708=1;1446710=1;1446711=1;1446713=1;1446714=1;1446715=1;1446716=1;1446717=1;1446718=1;1446719=1;
1446720=1;1446721=1;1446722=1;1446723=1;1446724=1;1446725=1;1446726=1;1446727=1;1446728=1;1446729=1;1446730=1;
1446731=1;1446732=1;1446733=1;1446734=1;1446735=1;1446739=1;1446740=1;1446741=1;1446742=1;1446743=1;1446744=1;
1446747=1;1446748=1;1446750=1;1446751=1;1446752=1;1446753=1;1446754=1;1446756=1;1446760=1;1446763=1;1446764=1;
1446765=1;1446766=1;1446768=1;1452720=1;1453472=1;1455601=1;1457300=1;1499973=13;168927=2;1806490=1;1813821=1;
1886517=1;1935181=1;1954351=1;208962=18;2093868=1;2093869=1;2093897=1;2093899=1;2093901=1;2137852=1;2137853=1;
2162662=1;2163603=1;216592=1;316385=1;316401=1;316407=2;331111=2;331112=1;340184=2;340185=1;344601=1;344610=1;
358708=1;358709=1;373045=3;373384=1;37762=2;409438=1;413997=1;439855=1;457400=1;457401=1;469008=2;475609=2;
481805=2;48296=1;498388=1;502347=1;511145=11;536056=2;543=10;548474=1;550672=1;550674=1;550675=1;550677=1;
550678=1;550679=1;550682=1;550683=1;550687=1;550688=1;550689=1;550690=1;550693=1;550694=1;556266=2;561=14;
562=3269;564=13;566546=3;571=1;573235=1;573=1;585034=1;585054=1;585055=1;585056=2;585057=2;585395=1;585396=1;
595495=2;595496=1;621=9;622=5;623=20;624=55;626531=1;656372=1;656379=1;656380=1;656381=1;656383=1;656393=1;
656396=1;656397=2;656400=1;656402=2;656404=1;656405=1;656408=1;656410=1;656411=2;656413=1;656414=2;656415=1;
656420=1;656421=1;656423=1;656427=1;656435=1;656437=1;656441=1;656442=1;656443=1;656444=1;656449=1;670888=1;
670890=1;670892=1;670893=1;670894=1;670896=2;670903=1;670904=1;670905=1;679202=1;679204=1;679205=1;679206=1;
679207=1;679895=1;723603=1;749527=1;749531=1;749532=1;749533=1;749537=1;749538=1;749539=1;749540=1;749544=1;
749545=1;749549=1;752784=1;752785=1;752786=1;752787=1;752788=1;752790=1;754078=1;754079=1;754080=1;754081=1;
754082=1;754083=1;754084=1;754085=1;754086=1;754087=1;754089=1;754090=1;754336=1;758829=1;758830=1;758831=2;
758832=1;766138=1;766142=1;766154=2;766161=1;766166=1;77133=2;796392=1;83333=15;866768=1;868160=1;868161=1;
868162=1;868163=1;868164=1;868165=1;868167=1;868168=1;868169=1;868170=1;868171=1;868172=1;868173=1;868174=1;
868175=1;868176=1;868177=1;868178=1;868179=1;868180=1;868181=1;868182=1;868183=1;868184=1;868185=1;868186=1;
868187=1;868188=1;868189=1;868190=1;868191=1;868192=1;868193=1;868194=1;868195=1;868196=1;868197=1;868198=1;
868199=1;868200=1;868201=1;868202=1;868203=1;868204=1;868206=1;868207=1;868208=1;868209=1;868210=1;869669=1;
869670=1;869671=1;869672=1;869675=1;869676=1;869677=1;869678=1;869679=1;869680=1;869681=1;869682=1;869683=1;
869684=1;869687=1;869688=1;869689=1;869690=1;869691=1;869694=1;869695=1;910348=1;913091=1;932676=2;
941323=1;945434=1;981367=1;991910=2;991915=1

```

##### Sequence  `CCW09133` belongs to a cluster `9901357` 
* Top three taxonomic assignment within a cluster and their frequencies `[('155322', 220), ('1428', 208), ('1396', 134)]`
* confidence score:  `220/(220+208+134) = 0.39`

##### Sequence `KFV03115` belongs to the cluster `13041247`
*  Top three taxonomic assignment within a cluster and their frequencies `[('13735', 4), ('299123', 4), ('188344', 3)]`
* confidence score: `4/(4+4+3) = 0.37`


##### Sequencer ID `YP_950729`  belons to the cluster `83178931`
* Top three taxonomic assignment within a cluster and their frequencies `[('1282', 15), ('1197952', 2), ('1197953', 2)]`
* confidence score: ```15/(15+2+2) = 0.78```
